'use strict'

const mongo = require('breezy-core/src/db/mongoClient')()
var helpers = require('../../helpers');
var config = require('../../../config');
var _ = require('lodash');

var CACHE_KEY = 'BREEZY_APPLICATION_SETTINGS'
var CACHE_TTL = 86400 * 7
var DB_COLLECTION = 'application_settings'

/*
SCHEMA - APPLICATION_SETTINGS

{
  _id
  version
  tos_date
  updated_date
}

*/


var FIELDS = ['version', 'tos_date'];

module.exports = {

  getApplicationSettings: getApplicationSettings,
  updateApplicationSettings: updateApplicationSettings,

};


async function getApplicationSettings() {

  let settings
  try {
    settings = await helpers.cache.chooseCache(null).getAsync(CACHE_KEY)
  } catch (e) {
    console.error(e)
    return false
  }

  if (settings) {
    console.log('CACHE getApplicationSettings')
    return JSON.parse(settings);



9bae651d2257
e43bcec9a0e0
e3ab1e61dd09
335ce38b03ea
bc54fdf67859
71cce9a09315
ba7b7b8a9080
d6290e51627d

{ userId: '08cf60071ead',
  companyId: 'e16af8b6eb68',
  roles: [ 'manager', 'positionMember' ],
  positions: {
    manager : [],
    positionMember : []
  }
  permissions:
   { manager: { teamPosition: 15, teamCandidate: 15, security: 15 },
     positions: 2,
     task: 2 } }